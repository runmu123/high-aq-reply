<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é«˜æƒ…å•†å›å¤å™¨ - æœ¬åœ°promptç”Ÿæˆç‰ˆ</title>
    <style>
        :root {
            --primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --primary-color: #667eea;
            --secondary-color: #764ba2;
            --bg-color: #f8fafc;
            --card-bg: #ffffff;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --text-muted: #94a3b8;
            --border-color: #e2e8f0;
            --success-color: #10b981;
            --error-color: #ef4444;
            --shadow-sm: 0 1px 3px rgba(0,0,0,0.06);
            --shadow-md: 0 4px 12px rgba(0,0,0,0.08);
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans SC', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-primary);
            line-height: 1.6;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 24px;
        }

        .header {
            text-align: center;
            margin-bottom: 32px;
            padding: 20px;
            background: var(--primary);
            color: white;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-md);
        }

        .header h1 {
            font-size: 28px;
            font-weight: 600;
        }

        .section {
            background: var(--card-bg);
            border-radius: var(--radius-md);
            padding: 20px;
            margin-bottom: 24px;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color);
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .form-row {
            display: flex;
            gap: 16px;
            margin-bottom: 16px;
        }

        .select-wrapper {
            flex: 1;
            position: relative;
        }

        .select-wrapper::after {
            content: "â–¼";
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-muted);
            pointer-events: none;
        }

        select {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            font-size: 14px;
            appearance: none;
            background: white;
        }

        textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            font-size: 14px;
            resize: vertical;
            min-height: 100px;
            font-family: inherit;
        }

        .generate-btn {
            width: 100%;
            padding: 14px;
            font-size: 16px;
            margin-top: 8px;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
        }

        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: var(--radius-sm);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            opacity: 0.9;
            transform: translateY(-1px);
        }

        .btn-success {
            background: var(--success-color);
            color: white;
        }

        .btn-success:hover {
            opacity: 0.9;
        }

        .btn-secondary {
            background: var(--border-color);
            color: var(--text-primary);
        }

        .btn-secondary:hover {
            background: var(--text-muted);
        }

        .btn-danger {
            background: var(--error-color);
            color: white;
        }

        .prompt-section {
            display: none;
        }

        .prompt-display {
            background: #f7f9fc;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            padding: 16px;
            margin-top: 16px;
            position: relative;
            white-space: pre-wrap;
            word-wrap: break-word;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 13px;
            line-height: 1.5;
            max-height: 300px;
            overflow-y: auto;
        }

        .prompt-actions {
            display: flex;
            justify-content: flex-end;
            gap: 12px;
            margin-top: 12px;
        }

        .copy-btn {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .history-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .history-item {
            padding: 12px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .history-info {
            flex: 1;
        }

        .history-time {
            font-size: 12px;
            color: var(--text-muted);
        }

        .history-role-scene {
            font-size: 14px;
            color: var(--text-secondary);
            margin: 4px 0;
        }

        .history-input {
            font-size: 14px;
            color: var(--text-primary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 300px;
        }

        .history-actions {
            display: flex;
            gap: 8px;
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 12px;
        }

        .error-message {
            background: #fee2e2;
            color: var(--error-color);
            padding: 12px;
            border-radius: var(--radius-sm);
            margin: 16px 0;
            display: none;
        }

        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-muted);
        }

        .prompt-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .prompt-length {
            font-size: 12px;
            color: var(--text-muted);
        }

        @media (max-width: 768px) {
            .container {
                padding: 16px;
            }
            
            .form-row {
                flex-direction: column;
            }
            
            .history-input {
                max-width: 200px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>é«˜æƒ…å•†å›å¤å™¨ - æœ¬åœ°promptç”Ÿæˆç‰ˆ</h1>
        </header>

        <div class="section">
            <div class="form-row">
                <div class="select-wrapper">
                    <select id="roleSelect">
                        <option value="">é€‰æ‹©è§’è‰²</option>
                        <option value="æœ‹å‹">æœ‹å‹</option>
                        <option value="å®¶äºº">å®¶äºº</option>
                        <option value="æš§æ˜§å¯¹è±¡">æš§æ˜§å¯¹è±¡</option>
                        <option value="ç›¸äº²å¯¹è±¡">ç›¸äº²å¯¹è±¡</option>
                        <option value="ç”·æœ‹å‹">ç”·æœ‹å‹</option>
                    </select>
                </div>
                <div class="select-wrapper">
                    <select id="sceneSelect">
                        <option value="">é€‰æ‹©åœºæ™¯</option>
                        <option value="é“æ­‰">é“æ­‰</option>
                        <option value="è¡¨ç™½">è¡¨ç™½</option>
                        <option value="æ‹’ç»">æ‹’ç»</option>
                        <option value="å®‰æ…°">å®‰æ…°</option>
                        <option value="æ—¥å¸¸">æ—¥å¸¸</option>
                        <option value="çº¦ä¼š">çº¦ä¼š</option>
                        <option value="èŠå¤©">èŠå¤©</option>
                    </select>
                </div>
            </div>

            <textarea id="dialogueInput" placeholder="è¯·è¾“å…¥éœ€è¦å›å¤çš„å¯¹è¯å†…å®¹ï¼Œä¾‹å¦‚ï¼šä»Šå¤©ä¸Šç­å¥½ç´¯å•Š..."></textarea>

            <button id="generateBtn" class="btn btn-primary generate-btn">
                ğŸ”® ç”ŸæˆPrompt
            </button>

            <div class="error-message" id="errorMessage"></div>
        </div>

        <div class="section prompt-section" id="promptSection">
            <div class="prompt-header">
                <div class="section-title">ğŸ“‹ ç”Ÿæˆçš„Prompt</div>
                <div class="prompt-length" id="promptLength">0 å­—ç¬¦</div>
            </div>
            
            <div class="prompt-display" id="promptDisplay"></div>
            
            <div class="prompt-actions">
                <button id="copyPromptBtn" class="btn btn-success copy-btn">
                    ğŸ“‹ å¤åˆ¶Prompt
                </button>
                <button id="copySystemOnlyBtn" class="btn btn-secondary copy-btn">
                    ğŸ“„ ä»…å¤åˆ¶ç³»ç»Ÿæç¤º
                </button>
            </div>
        </div>

        <div class="section">
            <div class="history-header">
                <div class="section-title">ğŸ“œ å†å²è®°å½• (<span id="historyCount">0</span>)</div>
                <button id="clearHistoryBtn" class="btn btn-danger btn-small">æ¸…ç©º</button>
            </div>
            <div class="history-list" id="historyList">
                <div class="empty-state">æš‚æ— å†å²è®°å½•</div>
            </div>
        </div>
    </div>

    <script>
        // ç³»ç»Ÿæç¤ºè¯æ¨¡æ¿
        const SYSTEM_PROMPTS = {
            'æœ‹å‹': {
                'é“æ­‰': `ä½ æ˜¯ç”¨æˆ·çš„é—ºèœœæˆ–å…„å¼Ÿï¼Œè¯­è¨€è½»æ¾å¹½é»˜ï¼Œå¯ä»¥å¼€ç©ç¬‘ä½†è¦çœŸè¯šã€‚
è¦æ±‚ï¼š
1. è¯­è¨€ä¿çš®ï¼Œå¸¦ç‚¹è°ƒä¾ƒä½†ä¸è¿‡åº¦
2. è¡¨è¾¾æ­‰æ„çš„åŒæ—¶ç»™å¯¹æ–¹å°é˜¶ä¸‹
3. é€‚åˆæœ‹å‹ä¹‹é—´çš„ç›¸å¤„æ–¹å¼
4. å›å¤ç®€æ´è‡ªç„¶ï¼Œ30å­—ä»¥å†…`,
                'è¡¨ç™½': `ä½ æ˜¯ç”¨æˆ·æš—æ‹å¯¹è±¡çš„æœ‹å‹ï¼Œå¸®åŠ©ç”¨æˆ·å‘å¿ƒä»ªçš„äººè¡¨ç™½ã€‚
è¦æ±‚ï¼š
1. è¯­è¨€ä¿çš®ä½†ä¸å¤±çœŸè¯š
2. æ—¢è¡¨è¾¾å¿ƒæ„åˆä¸ç»™å¯¹æ–¹å¤ªå¤§å‹åŠ›
3. å¯ä»¥æš—ç¤ºä½†ä¸è¦å¤ªç›´ç™½
4. å›å¤ç®€æ´è‡ªç„¶ï¼Œ30å­—ä»¥å†…`,
                'æ‹’ç»': `ä½ æ˜¯ç”¨æˆ·çš„æŸå‹ï¼Œå¸®åŠ©ç”¨æˆ·å§”å©‰æ‹’ç»æœ‹å‹ä¸åˆç†çš„è¦æ±‚ã€‚
è¦æ±‚ï¼š
1. è¯­æ°”è½»æ¾ä½†æ€åº¦æ˜ç¡®
2. ç»™å¯¹æ–¹ç•™é¢å­ï¼Œä¸ä¼¤å’Œæ°”
3. å¯ä»¥ç”¨ç©ç¬‘çš„æ–¹å¼è¡¨è¾¾
4. å›å¤ç®€æ´è‡ªç„¶ï¼Œ30å­—ä»¥å†…`,
                'å®‰æ…°': `ä½ æ˜¯ç”¨æˆ·çš„é—ºèœœ/å…„å¼Ÿï¼Œåœ¨ç”¨æˆ·æœ‹å‹é‡åˆ°å›°éš¾æ—¶æä¾›å®‰æ…°ã€‚
è¦æ±‚ï¼š
1. çœŸè¯šä½†ä¸è¿‡äºæ²‰é‡
2. æä¾›å®é™…çš„æ”¯æŒå’Œå»ºè®®
3. è¯­è¨€ç§¯æå‘ä¸Š
4. å›å¤ç®€æ´è‡ªç„¶ï¼Œ30å­—ä»¥å†…`,
                'æ—¥å¸¸': `ä½ æ˜¯ç”¨æˆ·çš„é—ºèœœ/å…„å¼Ÿï¼Œè¿›è¡Œè½»æ¾éšæ„çš„æ—¥å¸¸èŠå¤©ã€‚
è¦æ±‚ï¼š
1. è¯­è¨€è½»æ¾è‡ªç„¶ï¼Œå¯ä»¥å¼€ç©ç¬‘
2. è¯é¢˜å»¶ç»­æ€§å¼º
3. ä½“ç°æœ‹å‹é—´çš„äº²å¯†æ„Ÿ
4. å›å¤ç®€æ´è‡ªç„¶ï¼Œ30å­—ä»¥å†…`,
                'èŠå¤©': `ä½ æ˜¯ç”¨æˆ·çš„é—ºèœœ/å…„å¼Ÿï¼Œå’Œç”¨æˆ·è¿›è¡Œæ—¥å¸¸é—²èŠã€‚
è¦æ±‚ï¼š
1. è¯­è¨€è½»æ¾è‡ªç„¶
2. é€‚å½“å»¶ç»­è¯é¢˜
3. ä½“ç°æœ‹å‹é—´çš„é»˜å¥‘
4. å›å¤ç®€æ´è‡ªç„¶ï¼Œ30å­—ä»¥å†…`
            },
            'å®¶äºº': {
                'é“æ­‰': `ä½ æ˜¯ä¸€ä¸ªæ¸©æš–è´´å¿ƒçš„å®¶äººï¼Œå¸®åŠ©ç”¨æˆ·å‘çˆ¶æ¯æˆ–å…¶ä»–å®¶äººé“æ­‰ã€‚
è¦æ±‚ï¼š
1. è¯­è¨€çœŸè¯šï¼Œå……æ»¡æ‚”æ„
2. è¡¨è¾¾å¯¹å®¶äººçš„å°Šé‡å’Œçˆ±
3. æ‰¿è¯ºæ”¹æ­£é”™è¯¯
4. å›å¤ç®€æ´è‡ªç„¶ï¼Œ30å­—ä»¥å†…`,
                'è¡¨ç™½': `ä½ æ˜¯ç”¨æˆ·çš„å®¶äººï¼Œå¸®åŠ©ç”¨æˆ·å‘å®¶äººè¡¨è¾¾çˆ±æ„ã€‚
è¦æ±‚ï¼š
1. è¯­è¨€æ¸©é¦¨çœŸæŒš
2. è¡¨è¾¾å¯¹å®¶äººçš„æ„Ÿæ¿€
3. é€‚å½“è¡¨è¾¾å…³å¿ƒ
4. å›å¤ç®€æ´è‡ªç„¶ï¼Œ30å­—ä»¥å†…`,
                'æ‹’ç»': `ä½ æ˜¯ä¸€ä¸ªå­é¡ºçš„å®¶äººï¼Œå¸®åŠ©ç”¨æˆ·å§”å©‰æ‹’ç»å®¶äººçš„ä¸åˆç†è¦æ±‚ã€‚
è¦æ±‚ï¼š
1. è¯­æ°”æ¸©å’Œä½†æ€åº¦æ˜ç¡®
2. è§£é‡ŠåŸå› å¹¶è¡¨è¾¾æ­‰æ„
3. ä½“ç°å¯¹å®¶äººçš„å°Šé‡
4. å›å¤ç®€æ´è‡ªç„¶ï¼Œ30å­—ä»¥å†…`,
                'å®‰æ…°': `ä½ æ˜¯ç”¨æˆ·çš„å®¶äººï¼Œåœ¨å®¶äººé‡åˆ°å›°éš¾æ—¶æä¾›æ¸©æš–å®‰æ…°ã€‚
è¦æ±‚ï¼š
1. è¯­è¨€æ¸©æš–ï¼Œå……æ»¡å…³çˆ±
2. ç»™äºˆå®é™…çš„æ”¯æŒå’Œé™ªä¼´
3. ä¼ é€’ç§¯ææ­£èƒ½é‡
4. å›å¤ç®€æ´è‡ªç„¶ï¼Œ30å­—ä»¥å†…`,
                'æ—¥å¸¸': `ä½ æ˜¯ç”¨æˆ·çš„å®¶äººï¼Œè¿›è¡Œæ¸©é¦¨çš„å®¶åº­æ—¥å¸¸å¯¹è¯ã€‚
è¦æ±‚ï¼š
1. è¯­è¨€æ¸©é¦¨è‡ªç„¶
2. ä½“ç°å®¶äººé—´çš„å…³çˆ±
3. é€‚å½“è¡¨è¾¾å…³å¿ƒ
4. å›å¤ç®€æ´è‡ªç„¶ï¼Œ30å­—ä»¥å†…`,
                'èŠå¤©': `ä½ æ˜¯ç”¨æˆ·çš„å®¶äººï¼Œå’Œç”¨æˆ·è¿›è¡Œæ¸©é¦¨çš„æ—¥å¸¸èŠå¤©ã€‚
è¦æ±‚ï¼š
1. è¯­è¨€æ¸©é¦¨è‡ªç„¶
2. ä½“ç°å®¶äººé—´çš„äº²å¯†
3. é€‚å½“è¡¨è¾¾å…³å¿ƒ
4. å›å¤ç®€æ´è‡ªç„¶ï¼Œ30å­—ä»¥å†…`
            },
            'æš§æ˜§å¯¹è±¡': {
                'é“æ­‰': `ä½ æ˜¯ç”¨æˆ·çš„æš§æ˜§å¯¹è±¡ï¼Œåœ¨äº§ç”ŸçŸ›ç›¾æ—¶å¸®åŠ©ç”¨æˆ·é“æ­‰ã€‚
è¦æ±‚ï¼š
1. è¯­è¨€ä¿çš®ä½†ä¸å¤±è¯šæ„
2. é€‚å½“æ’’å¨‡åŒ–è§£çŸ›ç›¾
3. è¡¨è¾¾å¯¹å¯¹æ–¹çš„åœ¨æ„
4. å›å¤ç®€æ´è‡ªç„¶ï¼Œ30å­—ä»¥å†…ï¼Œç•¥å¸¦æš§æ˜§æ„Ÿ`,
                'è¡¨ç™½': `ä½ æ˜¯ç”¨æˆ·çš„æš§æ˜§å¯¹è±¡ï¼Œå¸®åŠ©ç”¨æˆ·å‘å¿ƒä»ªçš„äººè¡¨ç™½ã€‚
è¦æ±‚ï¼š
1. è¯­è¨€æµªæ¼«ä½†ä¸è¿‡äºç›´ç™½
2. åˆ¶é€ æš§æ˜§æ°›å›´
3. ä¿æŒé€‚å½“çš„ç¥ç§˜æ„Ÿ
4. å›å¤ç®€æ´è‡ªç„¶ï¼Œ30å­—ä»¥å†…`,
                'æ‹’ç»': `ä½ æ˜¯ç”¨æˆ·çš„æš§æ˜§å¯¹è±¡ï¼Œå¸®åŠ©ç”¨æˆ·å§”å©‰æ‹’ç»æš§æ˜§å¯¹è±¡çš„é‚€è¯·ã€‚
è¦æ±‚ï¼š
1. è¯­æ°”å§”å©‰ä½†æ€åº¦æ˜ç¡®
2. ä¸ä¼¤å¯¹æ–¹é¢å­
3. ä¿æŒé€‚å½“çš„ç¤¼è²Œå’Œè·ç¦»
4. å›å¤ç®€æ´è‡ªç„¶ï¼Œ30å­—ä»¥å†…`,
                'å®‰æ…°': `ä½ æ˜¯ç”¨æˆ·çš„æš§æ˜§å¯¹è±¡ï¼Œåœ¨å¯¹æ–¹æƒ…ç»ªä½è½æ—¶æä¾›å®‰æ…°ã€‚
è¦æ±‚ï¼š
1. è¯­è¨€æ¸©æŸ”ç»†è…»
2. è¡¨è¾¾å…³å¿ƒå’Œæ”¯æŒ
3. é€‚å½“æš§æ˜§ä½†ä¸è¿‡åº¦
4. å›å¤ç®€æ´è‡ªç„¶ï¼Œ30å­—ä»¥å†…`,
                'æ—¥å¸¸': `ä½ æ˜¯ç”¨æˆ·çš„æš§æ˜§å¯¹è±¡ï¼Œè¿›è¡Œå……æ»¡æš§æ˜§æ„Ÿçš„æ—¥å¸¸å¯¹è¯ã€‚
è¦æ±‚ï¼š
1. è¯­è¨€æ¸©æŸ”ç•¥å¸¦ä¿çš®
2. é€‚å½“è¡¨è¾¾æƒ³å¿µå’Œåœ¨æ„
3. åˆ¶é€ ç”œèœœæ°›å›´
4. å›å¤ç®€æ´è‡ªç„¶ï¼Œ30å­—ä»¥å†…`,
                'çº¦ä¼š': `ä½ æ˜¯ç”¨æˆ·çš„æš§æ˜§å¯¹è±¡ï¼Œå¸®åŠ©ç”¨æˆ·è§„åˆ’æˆ–å›åº”æš§æ˜§çº¦ä¼šã€‚
è¦æ±‚ï¼š
1. è¯­è¨€æµªæ¼«ç”œèœœ
2. è¡¨è¾¾æœŸå¾…å’Œå¼€å¿ƒ
3. é€‚å½“å±•ç°é­…åŠ›
4. å›å¤ç®€æ´è‡ªç„¶ï¼Œ30å­—ä»¥å†…`,
                'èŠå¤©': `ä½ æ˜¯ç”¨æˆ·çš„æš§æ˜§å¯¹è±¡ï¼Œå’Œç”¨æˆ·è¿›è¡Œæš§æ˜§çš„æ—¥å¸¸èŠå¤©ã€‚
è¦æ±‚ï¼š
1. è¯­è¨€æ¸©æŸ”ç•¥å¸¦ä¿çš®
2. é€‚å½“è°ƒæƒ…ä½†ä¸è¿‡åº¦
3. ä¿æŒç¥ç§˜æ„Ÿå’Œå¸å¼•åŠ›
4. å›å¤ç®€æ´è‡ªç„¶ï¼Œ30å­—ä»¥å†…`
            },
            'ç›¸äº²å¯¹è±¡': {
                'é“æ­‰': `ä½ æ˜¯ç”¨æˆ·çš„ç›¸äº²å¯¹è±¡ï¼Œåœ¨äº§ç”Ÿè¯¯ä¼šæ—¶å¸®åŠ©ç”¨æˆ·é“æ­‰ã€‚
è¦æ±‚ï¼š
1. è¯­è¨€ç¤¼è²ŒçœŸè¯š
2. è¡¨è¾¾æ­‰æ„å’Œé‡è§†
3. å±•ç°æˆç†Ÿç¨³é‡
4. å›å¤ç®€æ´è‡ªç„¶ï¼Œ30å­—ä»¥å†…`,
                'è¡¨ç™½': `ä½ æ˜¯ç”¨æˆ·çš„ç›¸äº²å¯¹è±¡ï¼Œå¸®åŠ©ç”¨æˆ·å‘ç›¸äº²å¯¹è±¡è¡¨è¾¾å¥½æ„Ÿã€‚
è¦æ±‚ï¼š
1. è¯­è¨€çœŸè¯šå¾—ä½“
2. è¡¨è¾¾è¯šæ„ä½†ä¸è¿‡åº¦çƒ­æƒ…
3. å±•ç°è‡ªå·±çš„ä¼˜ç‚¹
4. å›å¤ç®€æ´è‡ªç„¶ï¼Œ30å­—ä»¥å†…`,
                'æ‹’ç»': `ä½ æ˜¯ç”¨æˆ·çš„ç›¸äº²å¯¹è±¡ï¼Œå¸®åŠ©ç”¨æˆ·å§”å©‰æ‹’ç»ç›¸äº²å¯¹è±¡ã€‚
è¦æ±‚ï¼š
1. è¯­æ°”ç¤¼è²Œæ¸©å’Œ
2. è¡¨è¾¾æ„Ÿè°¢å’Œæ­‰æ„
3. ä¸ä¼¤å¯¹æ–¹é¢å­
4. å›å¤ç®€æ´è‡ªç„¶ï¼Œ30å­—ä»¥å†…`,
                'å®‰æ…°': `ä½ æ˜¯ç”¨æˆ·çš„ç›¸äº²å¯¹è±¡ï¼Œåœ¨ç›¸äº²å¯¹è±¡é‡åˆ°å›°éš¾æ—¶æä¾›å®‰æ…°ã€‚
è¦æ±‚ï¼š
1. è¯­è¨€ç¤¼è²Œå¾—ä½“
2. è¡¨è¾¾é€‚åº¦å…³å¿ƒ
3. å±•ç°ç»…å£«/æ·‘å¥³é£åº¦
4. å›å¤ç®€æ´è‡ªç„¶ï¼Œ30å­—ä»¥å†…`,
                'æ—¥å¸¸': `ä½ æ˜¯ç”¨æˆ·çš„ç›¸äº²å¯¹è±¡ï¼Œè¿›è¡Œç¤¼è²Œå¾—ä½“çš„æ—¥å¸¸å¯¹è¯ã€‚
è¦æ±‚ï¼š
1. è¯­è¨€ç¤¼è²Œè‡ªç„¶
2. é€‚å½“å±•ç°è‡ªå·±
3. ä¿æŒé€‚åº¦è·ç¦»
4. å›å¤ç®€æ´è‡ªç„¶ï¼Œ30å­—ä»¥å†…`,
                'èŠå¤©': `ä½ æ˜¯ç”¨æˆ·çš„ç›¸äº²å¯¹è±¡ï¼Œå’Œç”¨æˆ·è¿›è¡Œç¤¼è²Œçš„æ—¥å¸¸èŠå¤©ã€‚
è¦æ±‚ï¼š
1. è¯­è¨€ç¤¼è²Œå¾—ä½“
2. é€‚å½“å»¶ç»­è¯é¢˜
3. å±•ç°è¯šæ„å’Œå°Šé‡
4. å›å¤ç®€æ´è‡ªç„¶ï¼Œ30å­—ä»¥å†…`
            },
            'ç”·æœ‹å‹': {
                'é“æ­‰': `ä½ æ˜¯ç”¨æˆ·çš„ç”·æœ‹å‹ï¼Œå¸®åŠ©ç”¨æˆ·å‘ç”·æœ‹å‹é“æ­‰ã€‚
è¦æ±‚ï¼š
1. è¯­è¨€çœŸè¯šæ·±æƒ…
2. æ‰¿è®¤é”™è¯¯ï¼Œè¡¨è¾¾æ‚”æ„
3. é€‚å½“æ’’å¨‡æ±‚åŸè°…
4. è¡¨è¾¾å¯¹å¥³å‹çš„åœ¨æ„å’Œçˆ±
5. å›å¤ç®€æ´è‡ªç„¶ï¼Œ30å­—ä»¥å†…`,
                'è¡¨ç™½': `ä½ æ˜¯ç”¨æˆ·çš„ç”·æœ‹å‹ï¼Œå¸®åŠ©ç”¨æˆ·å‘ç”·æœ‹å‹è¡¨è¾¾çˆ±æ„ã€‚
è¦æ±‚ï¼š
1. è¯­è¨€æµªæ¼«æ·±æƒ…
2. è¡¨è¾¾å¯¹å¥¹çš„çˆ±å’Œçè§†
3. å¯ä»¥è®¸ä¸‹æ‰¿è¯º
4. å›å¤ç®€æ´è‡ªç„¶ï¼Œ30å­—ä»¥å†…`,
                'æ‹’ç»': `ä½ æ˜¯ç”¨æˆ·çš„ç”·æœ‹å‹ï¼Œå¸®åŠ©ç”¨æˆ·å§”å©‰æ‹’ç»ç”·æœ‹å‹çš„è¦æ±‚ã€‚
è¦æ±‚ï¼š
1. è¯­è¨€æ¸©æŸ”ä½†æ€åº¦æ˜ç¡®
2. è§£é‡ŠåŸå› ï¼Œæ±‚å¾—ç†è§£
3. è¡¨è¾¾æ­‰æ„å’Œçˆ±æ„
4. å›å¤ç®€æ´è‡ªç„¶ï¼Œ30å­—ä»¥å†…`,
                'å®‰æ…°': `ä½ æ˜¯ç”¨æˆ·çš„ç”·æœ‹å‹ï¼Œåœ¨ç”·æœ‹å‹æƒ…ç»ªä½è½æ—¶æä¾›å®‰æ…°ã€‚
è¦æ±‚ï¼š
1. è¯­è¨€æ¸©æŸ”å……æ»¡çˆ±æ„
2. ç»™äºˆæ‹¥æŠ±å’Œå®‰å…¨æ„Ÿ
3. æ”¯æŒå’Œé™ªä¼´
4. å›å¤ç®€æ´è‡ªç„¶ï¼Œ30å­—ä»¥å†…`,
                'æ—¥å¸¸': `ä½ æ˜¯ç”¨æˆ·çš„ç”·æœ‹å‹ï¼Œå’Œç”¨æˆ·è¿›è¡Œç”œèœœçš„æ—¥å¸¸å¯¹è¯ã€‚
è¦æ±‚ï¼š
1. è¯­è¨€æ¸©æŸ”ç”œèœœ
2. é€‚å½“æ’’å¨‡å’Œè¡¨è¾¾çˆ±æ„
3. å±•ç°å¯çˆ±ä¸€é¢
4. å›å¤ç®€æ´è‡ªç„¶ï¼Œ30å­—ä»¥å†…`,
                'çº¦ä¼š': `ä½ æ˜¯ç”¨æˆ·çš„ç”·æœ‹å‹ï¼Œå¸®åŠ©ç”¨æˆ·è§„åˆ’æˆ–å›åº”çº¦ä¼šã€‚
è¦æ±‚ï¼š
1. è¯­è¨€å…´å¥‹æœŸå¾…
2. è¡¨è¾¾å¯¹çº¦ä¼šçš„æœŸå¾…
3. å±•ç°æµªæ¼«ä¸€é¢
4. å›å¤ç®€æ´è‡ªç„¶ï¼Œ30å­—ä»¥å†…`,
                'èŠå¤©': `ä½ æ˜¯ç”¨æˆ·çš„ç”·æœ‹å‹ï¼Œå’Œç”¨æˆ·è¿›è¡Œç”œèœœçš„æ—¥å¸¸èŠå¤©ã€‚
è¦æ±‚ï¼š
1. è¯­è¨€æ¸©æŸ”ç”œèœœ
2. é€‚å½“æ’’å¨‡å’Œåˆ†äº«
3. è¡¨è¾¾æƒ³å¿µå’Œçˆ±æ„
4. å›å¤ç®€æ´è‡ªç„¶ï¼Œ30å­—ä»¥å†…`
            }
        };

        // DOMå…ƒç´ 
        const roleSelect = document.getElementById('roleSelect');
        const sceneSelect = document.getElementById('sceneSelect');
        const dialogueInput = document.getElementById('dialogueInput');
        const generateBtn = document.getElementById('generateBtn');
        const errorMessage = document.getElementById('errorMessage');
        const promptSection = document.getElementById('promptSection');
        const promptDisplay = document.getElementById('promptDisplay');
        const promptLength = document.getElementById('promptLength');
        const copyPromptBtn = document.getElementById('copyPromptBtn');
        const copySystemOnlyBtn = document.getElementById('copySystemOnlyBtn');
        const historyCount = document.getElementById('historyCount');
        const historyList = document.getElementById('historyList');
        const clearHistoryBtn = document.getElementById('clearHistoryBtn');

        // åˆå§‹åŒ–
        function init() {
            // åŠ è½½å†å²è®°å½•
            loadHistory();

            // ç»‘å®šäº‹ä»¶
            generateBtn.addEventListener('click', generatePrompt);
            copyPromptBtn.addEventListener('click', () => copyPrompt('full'));
            copySystemOnlyBtn.addEventListener('click', () => copyPrompt('system'));
            clearHistoryBtn.addEventListener('click', clearHistory);
        }

        // ç”ŸæˆPrompt
        function generatePrompt() {
            const role = roleSelect.value;
            const scene = sceneSelect.value;
            const dialogue = dialogueInput.value.trim();

            if (!role) {
                showError('è¯·é€‰æ‹©è§’è‰²');
                return;
            }

            if (!scene) {
                showError('è¯·é€‰æ‹©åœºæ™¯');
                return;
            }

            if (!dialogue) {
                showError('è¯·è¾“å…¥å¯¹è¯å†…å®¹');
                return;
            }

            // éšè—é”™è¯¯ä¿¡æ¯
            hideError();

            try {
                // è·å–ç³»ç»Ÿæç¤ºè¯
                const systemPrompt = SYSTEM_PROMPTS[role][scene];
                
                // æ„å»ºå®Œæ•´prompt
                const fullPrompt = buildFullPrompt(role, scene, dialogue, systemPrompt);
                
                // æ˜¾ç¤ºprompt
                displayPrompt(fullPrompt, systemPrompt);
                
                // ä¿å­˜åˆ°å†å²è®°å½•
                saveToHistory(role, scene, dialogue, fullPrompt, systemPrompt);
                
            } catch (error) {
                console.error('ç”Ÿæˆpromptå¤±è´¥:', error);
                showError(`ç”Ÿæˆpromptå¤±è´¥: ${error.message}`);
            }
        }

        // æ„å»ºå®Œæ•´prompt
        function buildFullPrompt(role, scene, dialogue, systemPrompt) {
            return `[ç³»ç»Ÿæç¤º]
${systemPrompt}

[ç”¨æˆ·è¾“å…¥]
è§’è‰²ï¼š${role}
åœºæ™¯ï¼š${scene}
å¯¹è¯ï¼š${dialogue}

[ä»»åŠ¡è¦æ±‚]
è¯·æ ¹æ®ç³»ç»Ÿæç¤ºå’Œç”¨æˆ·è¾“å…¥ï¼Œç”Ÿæˆ10æ¡é«˜æƒ…å•†å›å¤ï¼Œæ¯æ¡å›å¤ä¸è¶…è¿‡30å­—ï¼Œå›å¤æ ¼å¼ä¸ºï¼š
1. ç¬¬ä¸€æ¡å›å¤
2. ç¬¬äºŒæ¡å›å¤
...
10. ç¬¬åæ¡å›å¤`;
        }

        // æ˜¾ç¤ºprompt
        function displayPrompt(fullPrompt, systemPrompt) {
            // æ˜¾ç¤ºå®Œæ•´prompt
            promptDisplay.textContent = fullPrompt;
            
            // æ›´æ–°å­—ç¬¦æ•°
            const charCount = fullPrompt.length;
            promptLength.textContent = `${charCount} å­—ç¬¦`;
            
            // æ˜¾ç¤ºpromptåŒºåŸŸ
            promptSection.style.display = 'block';
            
            // ä¿å­˜å½“å‰promptåˆ°ä¸´æ—¶å˜é‡
            window.currentFullPrompt = fullPrompt;
            window.currentSystemPrompt = systemPrompt;
        }

        // å¤åˆ¶prompt
        function copyPrompt(type) {
            let textToCopy = '';
            
            if (type === 'full') {
                textToCopy = window.currentFullPrompt || promptDisplay.textContent;
            } else if (type === 'system') {
                textToCopy = window.currentSystemPrompt || '';
            }
            
            if (!textToCopy) {
                showError('æ²¡æœ‰å¯å¤åˆ¶çš„å†…å®¹');
                return;
            }
            
            copyToClipboard(textToCopy);
            
            // ä¸´æ—¶æ”¹å˜æŒ‰é’®æ–‡æœ¬
            const originalText = type === 'full' 
                ? copyPromptBtn.innerHTML 
                : copySystemOnlyBtn.innerHTML;
            
            const button = type === 'full' ? copyPromptBtn : copySystemOnlyBtn;
            
            button.innerHTML = 'âœ… å·²å¤åˆ¶';
            button.disabled = true;
            
            setTimeout(() => {
                button.innerHTML = originalText;
                button.disabled = false;
            }, 2000);
        }

        // ä¿å­˜åˆ°å†å²è®°å½•
        function saveToHistory(role, scene, dialogue, fullPrompt, systemPrompt) {
            // è·å–ç°æœ‰å†å²è®°å½•
            let history = JSON.parse(localStorage.getItem('eq_prompt_history') || '[]');
            
            // åˆ›å»ºæ–°è®°å½•
            const newRecord = {
                id: generateId(),
                timestamp: Date.now(),
                role: role,
                scene: scene,
                input: dialogue,
                fullPrompt: fullPrompt,
                systemPrompt: systemPrompt
            };
            
            // æ·»åŠ åˆ°å†å²è®°å½•å¼€å¤´
            history.unshift(newRecord);
            
            // é™åˆ¶æœ€å¤šä¿å­˜20æ¡è®°å½•
            if (history.length > 20) {
                history = history.slice(0, 20);
            }
            
            // ä¿å­˜å›localStorage
            localStorage.setItem('eq_prompt_history', JSON.stringify(history));
            
            // æ›´æ–°UI
            loadHistory();
        }

        // åŠ è½½å†å²è®°å½•
        function loadHistory() {
            const history = JSON.parse(localStorage.getItem('eq_prompt_history') || '[]');
            historyCount.textContent = history.length;
            
            if (history.length === 0) {
                historyList.innerHTML = '<div class="empty-state">æš‚æ— å†å²è®°å½•</div>';
                return;
            }
            
            historyList.innerHTML = '';
            
            history.forEach(record => {
                const historyItem = document.createElement('div');
                historyItem.className = 'history-item';
                
                const date = new Date(record.timestamp);
                const timeString = `${date.getFullYear()}/${date.getMonth()+1}/${date.getDate()} ${date.getHours()}:${date.getMinutes().toString().padStart(2, '0')}`;
                
                historyItem.innerHTML = `
                    <div class="history-info">
                        <div class="history-time">${timeString}</div>
                        <div class="history-role-scene">${record.role} Â· ${record.scene}</div>
                        <div class="history-input">${record.input}</div>
                    </div>
                    <div class="history-actions">
                        <button class="btn btn-secondary btn-small view-history-btn" data-id="${record.id}">æŸ¥çœ‹</button>
                        <button class="btn btn-danger btn-small delete-history-btn" data-id="${record.id}">åˆ é™¤</button>
                    </div>
                `;
                
                historyList.appendChild(historyItem);
            });
            
            // ç»‘å®šæŸ¥çœ‹å’Œåˆ é™¤æŒ‰é’®äº‹ä»¶
            document.querySelectorAll('.view-history-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    viewHistoryItem(id);
                });
            });
            
            document.querySelectorAll('.delete-history-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    deleteHistoryItem(id);
                });
            });
        }

        // æŸ¥çœ‹å†å²è®°å½•é¡¹
        function viewHistoryItem(id) {
            const history = JSON.parse(localStorage.getItem('eq_prompt_history') || '[]');
            const record = history.find(item => item.id === id);
            
            if (record) {
                // å¡«å……è¡¨å•
                roleSelect.value = record.role;
                sceneSelect.value = record.scene;
                dialogueInput.value = record.input;
                
                // æ˜¾ç¤ºprompt
                displayPrompt(record.fullPrompt, record.systemPrompt);
                
                // æ»šåŠ¨åˆ°promptåŒºåŸŸ
                promptSection.scrollIntoView({ behavior: 'smooth' });
            }
        }

        // åˆ é™¤å†å²è®°å½•é¡¹
        function deleteHistoryItem(id) {
            let history = JSON.parse(localStorage.getItem('eq_prompt_history') || '[]');
            history = history.filter(item => item.id !== id);
            localStorage.setItem('eq_prompt_history', JSON.stringify(history));
            loadHistory();
        }

        // æ¸…ç©ºå†å²è®°å½•
        function clearHistory() {
            if (confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰å†å²è®°å½•å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚')) {
                localStorage.removeItem('eq_prompt_history');
                loadHistory();
            }
        }

        // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
        function showError(message) {
            errorMessage.textContent = message;
            errorMessage.style.display = 'block';
        }

        // éšè—é”™è¯¯ä¿¡æ¯
        function hideError() {
            errorMessage.style.display = 'none';
        }

        // å¤åˆ¶åˆ°å‰ªè´´æ¿
        function copyToClipboard(text) {
            const textarea = document.createElement('textarea');
            textarea.value = text;
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand('copy');
            document.body.removeChild(textarea);
        }

        // ç”Ÿæˆå”¯ä¸€ID
        function generateId() {
            return Date.now().toString(36) + Math.random().toString(36).substr(2);
        }

        // åˆå§‹åŒ–åº”ç”¨
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>